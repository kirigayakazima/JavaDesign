<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mybatis | Java设计模式解读</title>
    <meta name="description" content="一个Java学习者的践行之路">
    <link rel="icon" href="/JavaDesign/logo1.jpg">
    
    <link rel="preload" href="/JavaDesign/assets/css/0.styles.c0030725.css" as="style"><link rel="preload" href="/JavaDesign/assets/js/app.e7717cda.js" as="script"><link rel="preload" href="/JavaDesign/assets/js/2.1544abce.js" as="script"><link rel="preload" href="/JavaDesign/assets/js/9.a69063dc.js" as="script"><link rel="prefetch" href="/JavaDesign/assets/js/10.6cb91e69.js"><link rel="prefetch" href="/JavaDesign/assets/js/11.6acc766e.js"><link rel="prefetch" href="/JavaDesign/assets/js/12.23b434c7.js"><link rel="prefetch" href="/JavaDesign/assets/js/13.c7bd56ab.js"><link rel="prefetch" href="/JavaDesign/assets/js/14.e6ba1455.js"><link rel="prefetch" href="/JavaDesign/assets/js/15.09f2a429.js"><link rel="prefetch" href="/JavaDesign/assets/js/16.0e02ad7e.js"><link rel="prefetch" href="/JavaDesign/assets/js/17.38582cdb.js"><link rel="prefetch" href="/JavaDesign/assets/js/18.2b1220b2.js"><link rel="prefetch" href="/JavaDesign/assets/js/19.9f1ec858.js"><link rel="prefetch" href="/JavaDesign/assets/js/20.eca2590a.js"><link rel="prefetch" href="/JavaDesign/assets/js/21.cd8c8aca.js"><link rel="prefetch" href="/JavaDesign/assets/js/22.2d19dd62.js"><link rel="prefetch" href="/JavaDesign/assets/js/23.5b221701.js"><link rel="prefetch" href="/JavaDesign/assets/js/24.c8619eb9.js"><link rel="prefetch" href="/JavaDesign/assets/js/25.3b56ad5f.js"><link rel="prefetch" href="/JavaDesign/assets/js/26.9cdd79f3.js"><link rel="prefetch" href="/JavaDesign/assets/js/27.7dfc9fef.js"><link rel="prefetch" href="/JavaDesign/assets/js/28.4b55146a.js"><link rel="prefetch" href="/JavaDesign/assets/js/29.454be148.js"><link rel="prefetch" href="/JavaDesign/assets/js/3.d635db73.js"><link rel="prefetch" href="/JavaDesign/assets/js/30.29b26fd1.js"><link rel="prefetch" href="/JavaDesign/assets/js/4.74670721.js"><link rel="prefetch" href="/JavaDesign/assets/js/5.caa88291.js"><link rel="prefetch" href="/JavaDesign/assets/js/6.04a9108a.js"><link rel="prefetch" href="/JavaDesign/assets/js/7.e74d07d9.js"><link rel="prefetch" href="/JavaDesign/assets/js/8.b9f62266.js">
    <link rel="stylesheet" href="/JavaDesign/assets/css/0.styles.c0030725.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/JavaDesign/" class="home-link router-link-active"><!----> <span class="site-name">Java设计模式解读</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/JavaDesign/" class="nav-link">首页</a></div><div class="nav-item"><a href="/JavaDesign/DataBase/DataBase01.html" class="nav-link">数据库</a></div><div class="nav-item"><a href="/JavaDesign/ConstBook/Const01.html" class="nav-link">数据结构</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java之路</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JavaDesign/JavaBaseBook/JavaBase01.html" class="nav-link">Java基础</a></li><li class="dropdown-item"><!----> <a href="/JavaDesign/ServletBook/Servlet01.html" class="nav-link">Servlet</a></li><li class="dropdown-item"><!----> <a href="/JavaDesign/FrameBook/Mybatis01.html" class="nav-link router-link-exact-active router-link-active">框架学习</a></li><li class="dropdown-item"><!----> <a href="/JavaDesign/SpringBootBook/SpringBoot01.html" class="nav-link">Spring Boot</a></li></ul></div></div><div class="nav-item"><a href="/JavaDesign/JavaBook/about.html" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">分享</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JavaDesign/ConstBook/Const01.html" class="nav-link">技术</a></li><li class="dropdown-item"><!----> <a href="/JavaDesign/FrameBook/.html" class="nav-link">奇闻妙事</a></li></ul></div></div> <a href="https://github.com/kirigayakazima/JavaDesign" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/JavaDesign/" class="nav-link">首页</a></div><div class="nav-item"><a href="/JavaDesign/DataBase/DataBase01.html" class="nav-link">数据库</a></div><div class="nav-item"><a href="/JavaDesign/ConstBook/Const01.html" class="nav-link">数据结构</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Java之路</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JavaDesign/JavaBaseBook/JavaBase01.html" class="nav-link">Java基础</a></li><li class="dropdown-item"><!----> <a href="/JavaDesign/ServletBook/Servlet01.html" class="nav-link">Servlet</a></li><li class="dropdown-item"><!----> <a href="/JavaDesign/FrameBook/Mybatis01.html" class="nav-link router-link-exact-active router-link-active">框架学习</a></li><li class="dropdown-item"><!----> <a href="/JavaDesign/SpringBootBook/SpringBoot01.html" class="nav-link">Spring Boot</a></li></ul></div></div><div class="nav-item"><a href="/JavaDesign/JavaBook/about.html" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">分享</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/JavaDesign/ConstBook/Const01.html" class="nav-link">技术</a></li><li class="dropdown-item"><!----> <a href="/JavaDesign/FrameBook/.html" class="nav-link">奇闻妙事</a></li></ul></div></div> <a href="https://github.com/kirigayakazima/JavaDesign" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/JavaDesign/FrameBook/Mybatis01.html" class="active sidebar-link">Mybatis</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JavaDesign/FrameBook/Mybatis01.html#环境搭建" class="sidebar-link">环境搭建</a></li><li class="sidebar-sub-header"><a href="/JavaDesign/FrameBook/Mybatis01.html#属性" class="sidebar-link">属性</a></li><li class="sidebar-sub-header"><a href="/JavaDesign/FrameBook/Mybatis01.html#实现新增和事务" class="sidebar-link">实现新增和事务</a></li><li class="sidebar-sub-header"><a href="/JavaDesign/FrameBook/Mybatis01.html#接口绑定方案和多参数传递" class="sidebar-link">接口绑定方案和多参数传递</a></li><li class="sidebar-sub-header"><a href="/JavaDesign/FrameBook/Mybatis01.html#动态sql" class="sidebar-link">动态SQL</a></li><li class="sidebar-sub-header"><a href="/JavaDesign/FrameBook/Mybatis01.html#线程容器-threadlocal" class="sidebar-link">线程容器 ThreadLocal</a></li><li class="sidebar-sub-header"><a href="/JavaDesign/FrameBook/Mybatis01.html#缓存" class="sidebar-link">缓存</a></li><li class="sidebar-sub-header"><a href="/JavaDesign/FrameBook/Mybatis01.html#实现多表查询" class="sidebar-link">实现多表查询</a></li></ul></li><li><a href="/JavaDesign/FrameBook/Log4j.html" class="sidebar-link">Log4j</a></li><li><a href="/JavaDesign/FrameBook/Spring01.html" class="sidebar-link">Spring</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mybatis"><a href="#mybatis" aria-hidden="true" class="header-anchor">#</a> Mybatis</h1> <p>规范：<br>
持久层：dao  persist   mapper
<br>
实体层：entity  model  bean  javabean  pojo
<br>
业务逻辑：service  biz
<br>
控制器：controller  servlet  action  web
<br>
过滤器：filter
<br>
监听器：listener
<br>
异常：exception</p> <h2 id="环境搭建"><a href="#环境搭建" aria-hidden="true" class="header-anchor">#</a> 环境搭建</h2> <h3 id="一、导入jar"><a href="#一、导入jar" aria-hidden="true" class="header-anchor">#</a> 一、导入jar</h3> <table><thead><tr><th>包名</th> <th>作用</th></tr></thead> <tbody><tr><td>asm</td> <td>Cglib依赖的包</td></tr> <tr><td>cglib</td> <td>动态代理包</td></tr> <tr><td>commons-logging</td> <td>日志包</td></tr> <tr><td>javassist</td> <td>字节码解析包也是cglib的依赖包</td></tr> <tr><td>log4j</td> <td>日志包</td></tr> <tr><td>log4j-api</td> <td>日志包</td></tr> <tr><td>log4j-core</td> <td>日志包</td></tr> <tr><td>mybatis</td> <td>Mybatis核心包</td></tr> <tr><td>slf4j-api</td> <td>日志包</td></tr> <tr><td>slf4j-log4j12</td> <td>日志包</td></tr></tbody></table> <h3 id="二、配置xml文件"><a href="#二、配置xml文件" aria-hidden="true" class="header-anchor">#</a> 二、配置xml文件</h3> <p>在src路径下配置一个xml文件，必须添加</p> <div class="language-Xml line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-xml"><code><span class="token doctype">&lt;!DOCTYPE configuration
  PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
  &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- default应用environment的id，当前使用的环境 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!-- 声明可以使用的环境，即数据库类型 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- 使用原生JDBC事务 --&gt;</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>JDBC<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transactionManager</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>POOLED<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>driver<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.mysql.jdbc.Driver<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>jdbc:mysql::/localhost:3306/407<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>uername<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>123456<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environments</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
	    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com/qym/mapper/FlowerMapper.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>然后在mapper目录下新建一个xml，配置编写sql语句</p> <div class="language-Xml line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-xml"><code><span class="token doctype">&lt;!DOCTYPE mapper
  PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
  &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="token comment">&lt;!-- namesapce:理解成实现类的全路径(包+类名)--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>a.b<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--id:方法
        parameterType:定义参数类型
        resultType:返回值类型
        
        如果方法返回值是list，在resultType中写list的泛型，因为mybatis是对jdbc封装，一行一行读取数据
    --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selAll<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token attr-name">com.qym.pojo.Flowers</span><span class="token punctuation">&gt;</span></span>
    select * from t_flower
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code>工厂模式
<span class="token class-name">InputStream</span> is <span class="token operator">=</span><span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;mybatis.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//使用工厂设计模式</span>
<span class="token class-name">SqlSessionFactory</span> factory<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//生产SqlSession</span>
<span class="token class-name">SqlSession</span> session<span class="token operator">=</span>factory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Flowers</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token string">&quot;a.b.selAll&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">FLowers</span> flower<span class="token operator">:</span>list<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flower<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>如果配置后没有提示那么
window--&gt;preference--&gt;XML--&gt;XML catalog--&gt;add按钮添加本地dtd文件
<br>
mybatis的优点，不用编写实现类，只需要写sql语句</p> <h3 id="四、全局配置文件"><a href="#四、全局配置文件" aria-hidden="true" class="header-anchor">#</a> 四、全局配置文件</h3> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token number">1.</span>全局配置文件中内容
    <span class="token number">1.1</span> <span class="token operator">&lt;</span>transactionManager<span class="token operator">/</span><span class="token operator">&gt;</span>type属性可取值
            <span class="token number">1.1</span><span class="token number">.1</span>  JDBC<span class="token punctuation">,</span>事务管理使用JDBC原生事务管理方式
            <span class="token number">1.1</span><span class="token number">.2</span>  MANAGED把事务管理转交给其他容器。原生JDBC事务<span class="token function">setAutoMapping</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token number">1.2</span> <span class="token operator">&lt;</span>dataSource<span class="token operator">/</span><span class="token operator">&gt;</span>可取值
            <span class="token number">1.2</span><span class="token number">.1</span>  POOLED 使用数据库连接池
            <span class="token number">1.2</span><span class="token number">.2</span>  UNPOOLED 不使用数据库连接池，和直接使用JDBC一样
            <span class="token number">1.2</span><span class="token number">.3</span>  JNDI java命名目录接口技术
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="五、数据库连接池"><a href="#五、数据库连接池" aria-hidden="true" class="header-anchor">#</a> 五、数据库连接池</h3> <p>1.在内存中开辟一块空间，存放多个数据库连接对象
<br>2.JDBC Tomcat Pool 直接由tomcat服务器产生数据库连接池
<br>3. active状态：当前连接对象被应用程序使用中
<br>ldle空间状态：等待应用程序使用
<br>4.使用数据库连接池的目的：在高频率访问数据库时，使用数据库连接池可以降低服务器系统压力，提升程序运行效果<br>小型项目不适用数据库连接池
<br>5.实现JDBC tomcat Pool数据库连接池的步骤</p> <div class="language-Xml line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-xml"><code>1.在web项目中的META-INF中存放context.xml

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context</span><span class="token punctuation">&gt;</span></span>
    &lt;Resource
        driverClassName=&quot;com.mysql.jdbc.Driver&quot;
        url=&quot;jdbc:mysql://localhost:3306/407&quot;
        username=&quot;root&quot;
        password=&quot;12456&quot;
        //最多50个并发量，50个连接对象处于连接，其他的等待
        maxActive=&quot;50&quot;
        //等待的个数
        maxIdle=&quot;20&quot;
        name=&quot;test&quot;
        auth=&quot;Container&quot;
        maxWait=&quot;10000&quot;
        type=&quot;javax.sql.DataSource&quot;
    /&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>把项目发布到tomcat，数据库连接池产生了
<br>6.可以在java中使用indi获取数据库连接池中的对象
<br>Context：上下文接口，context.xml文件对象类型
<br>代码：</p> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br></div><pre class="language-java"><code><span class="token class-name">Context</span> cxt<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">InitialContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DataSource</span> ds<span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span><span class="token punctuation">)</span> cxt<span class="token punctuation">.</span><span class="token function">looup</span><span class="token punctuation">(</span><span class="token string">&quot;java:comp/env/test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Connection</span> conn<span class="token operator">=</span>ds<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><br>当关闭连接对象时，把连接对象归还给数据库连接池，把状态改变成IdIe</p> <h3 id="六、三种查询方式"><a href="#六、三种查询方式" aria-hidden="true" class="header-anchor">#</a> 六、三种查询方式</h3> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token number">1.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>返回值为<span class="token class-name">List</span><span class="token operator">&lt;</span>resultType 属性控制<span class="token operator">&gt;</span>
    适用于查询结果都需要遍历的需求
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Flowers</span><span class="token punctuation">&gt;</span></span> list<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token string">&quot;a.b.selAll&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Flower</span> flower<span class="token operator">:</span>list<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flower<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token number">2.</span><span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span>返回值<span class="token class-name">Object</span>
    适用于返回结果只是变量或一行数据时
    <span class="token keyword">int</span> count<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token string">&quot;a.b.selById&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Sysoem</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">3.</span><span class="token function">selectMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>返回值<span class="token class-name">Map</span>
    适用于需求需要在查询结果中通过某列的值渠道这行数据的需求
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span>object<span class="token punctuation">&gt;</span></span>map<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">selectMap</span><span class="token punctuation">(</span><span class="token string">&quot;a.b.c&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;name123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="七、目录组成"><a href="#七、目录组成" aria-hidden="true" class="header-anchor">#</a> 七、目录组成</h3> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code>src____mybatis<span class="token punctuation">.</span>xml
<span class="token operator">|</span>   <span class="token operator">|</span>____com____qym
<span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span>               <span class="token operator">|</span>____mapper
<span class="token operator">|</span>               <span class="token operator">|</span>       <span class="token operator">|</span>________PeopleMapper<span class="token punctuation">.</span>xml
<span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span>               <span class="token operator">|</span>____pojo
<span class="token operator">|</span>               <span class="token operator">|</span>       <span class="token operator">|</span>________People<span class="token punctuation">.</span>java
<span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span>               <span class="token operator">|</span>____service
<span class="token operator">|</span>               <span class="token operator">|</span>       <span class="token operator">|</span>________PeopleService
<span class="token operator">|</span>               <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span>               <span class="token operator">|</span>       <span class="token operator">|</span>________Impl
<span class="token operator">|</span>               <span class="token operator">|</span>                   <span class="token operator">|</span>________PeopleServiceImpl
<span class="token operator">|</span>               <span class="token operator">|</span>
<span class="token operator">|</span>               <span class="token operator">|</span>____servlet
<span class="token operator">|</span>                       <span class="token operator">|</span>________ShowServlet
<span class="token operator">|</span>
<span class="token operator">|</span>
<span class="token operator">|</span>
<span class="token operator">|</span>
<span class="token operator">|</span>
<span class="token operator">|</span>
<span class="token class-name">WebRoot______________main</span>
            <span class="token operator">|</span>
            <span class="token operator">|</span>________index<span class="token punctuation">.</span>jsp    










</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="属性"><a href="#属性" aria-hidden="true" class="header-anchor">#</a> 属性</h2> <h3 id="一、parametertype属性"><a href="#一、parametertype属性" aria-hidden="true" class="header-anchor">#</a> 一、parameterType属性</h3> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token number">1.</span>在xxxMapper<span class="token punctuation">.</span>xml中的<span class="token generics"><span class="token punctuation">&lt;</span>select<span class="token punctuation">&gt;</span></span><span class="token generics"><span class="token punctuation">&lt;</span>delete<span class="token punctuation">&gt;</span></span>等标签的parameterType可以控制参数类型

<span class="token number">2.</span><span class="token class-name">SqlSession</span>的<span class="token function">selectList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>和<span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span>的第二个参数和<span class="token function">selectMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>的第三个参数都表示方法的参数
<span class="token operator">--</span><span class="token operator">-</span><span class="token number">2.1</span>示例：
    <span class="token class-name">People</span> p<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token string">&quot;a.b.selById&quot;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">-</span><span class="token number">2.2</span>在<span class="token class-name">Mapper</span><span class="token punctuation">.</span>xml中可以通过#<span class="token punctuation">{</span><span class="token punctuation">}</span>获取参数<span class="token punctuation">,</span>可以使用索引<span class="token number">1</span>可以使用#<span class="token punctuation">{</span>parameter1<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token operator">-</span>#<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>和#<span class="token punctuation">{</span>param <span class="token number">1</span><span class="token punctuation">}</span>表示的含义相同，都是表示第一个参数
<span class="token operator">--</span><span class="token operator">-</span>如果只有一个参数<span class="token punctuation">(</span>基本数据类型或者<span class="token class-name">String</span><span class="token punctuation">)</span>，mybatis对#<span class="token punctuation">{</span><span class="token punctuation">}</span>中的内容没有要求，只要写内容即可
<span class="token operator">--</span><span class="token operator">-</span>如果参数对象#<span class="token punctuation">{</span>属性名<span class="token punctuation">}</span>，如果参数是map写成#<span class="token punctuation">{</span>key<span class="token punctuation">}</span>
<span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">&quot;selById&quot;</span> resultType<span class="token operator">=</span><span class="token string">&quot;com.qym.pojo.People&quot;</span> parameterType<span class="token operator">=</span><span class="token string">&quot;int&quot;</span><span class="token operator">&gt;</span>
    select <span class="token operator">*</span> from people where id<span class="token operator">=</span>#<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>

<span class="token number">3.</span>#<span class="token punctuation">{</span><span class="token punctuation">}</span>和$<span class="token punctuation">{</span><span class="token punctuation">}</span>的区别（基本不用$<span class="token punctuation">{</span><span class="token punctuation">}</span>，面试相关）
<span class="token operator">--</span><span class="token operator">-</span><span class="token number">3.1</span>#<span class="token punctuation">{</span><span class="token punctuation">}</span>获取参数的内容支持索引获取，param1获取指定位置参数，并且sql使用？占位符
<span class="token operator">--</span><span class="token operator">-</span><span class="token number">3.2</span>$<span class="token punctuation">{</span><span class="token punctuation">}</span>字符串拼接不使用？，默认找$<span class="token punctuation">{</span>内容<span class="token punctuation">}</span>中的内容的get<span class="token operator">/</span>set方法，如果写一个数字，那么就是一个数字

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="二、实现分页"><a href="#二、实现分页" aria-hidden="true" class="header-anchor">#</a> 二、实现分页</h3> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code>java代码
<span class="token comment">//显示几个</span>
<span class="token keyword">int</span> pageSize<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">//第几页</span>
<span class="token keyword">int</span> pageNumber<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token comment">//如果希望传递多个参数，可以使用对象或者map</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;pageSize&quot;</span><span class="token punctuation">,</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;pageStart&quot;</span><span class="token punctuation">,</span>pageSize<span class="token operator">*</span><span class="token punctuation">(</span>pageNumber<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">People</span><span class="token punctuation">&gt;</span></span> p<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token string">&quot;a.b.page&quot;</span><span class="token punctuation">,</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-Xml line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br></div><pre class="language-xml"><code>在mapper.xml中代码
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.qym.pojo.People<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>map<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    select * from people limit #{pageStart},#{pageSize}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="三、别名"><a href="#三、别名" aria-hidden="true" class="header-anchor">#</a> 三、别名</h3> <p>系统内置别名：把类型全小写</p> <div class="language-Xml line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br></div><pre class="language-xml"><code>//把com.qym.pojo.People这个用别名peo替换，之后再mapper.xml中可以通过peo引用People类
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAliases</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAlias</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.qym.pojo.People<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alias</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>peo<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeAliases</span><span class="token punctuation">&gt;</span></span>


//直接给某个包所有类起个别名，别名为类名，区分大小写
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAliases</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.qym.pojo<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeAliases</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="实现新增和事务"><a href="#实现新增和事务" aria-hidden="true" class="header-anchor">#</a> 实现新增和事务</h2> <p>功能：从应用程序角度出发，软件具有哪些功能
<br>业务：完成功能的逻辑，对应service中的一个方法
<br>事务：从数据库角度出发，完成业务是需要执行的SQL集合，统称为一个事务
<br>在mybatis中默认是关闭了JDBC的自动提交功能<br></p> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-java"><code><span class="token comment">//提交事务</span>
session<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//自动提交</span>
<span class="token function">openSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>mybatis底层是对JDBC的封装</p> <div class="language-Xml line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br></div><pre class="language-xml"><code>1.JDBC中的executeUpdate()执行新增，删除，修改的SQL返回值int，表示受影响的行数
2.mybatis中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span><span class="token punctuation">&gt;</span></span> 标签没有resultType属性，认为返回值都是int 
3.openSession()时Mybatis会创建一个SqlSession时同时创建一个Transaction(事务对象),同时autoCommit都为false
4.在事务中如果出现异常，那么需要回滚数据，使用session().rellback();
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><em>核心代码serviceImpl实现</em></p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code>
<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">PageInfo</span> <span class="token function">showAll</span><span class="token punctuation">(</span><span class="token keyword">int</span> pageSize<span class="token punctuation">,</span> <span class="token keyword">int</span> pageNumber<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
		<span class="token comment">//获取资源</span>
		<span class="token class-name">InputStream</span> is<span class="token operator">=</span><span class="token class-name">Resources</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;mybatis.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//拿到资源后进行建造者工厂模式生产</span>
		<span class="token class-name">SqlSessionFactory</span> factory<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//打开资源</span>
		<span class="token class-name">SqlSession</span> session<span class="token operator">=</span>factory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//开始进行资源利用</span>
		<span class="token comment">//创建一个map对象</span>
		<span class="token comment">//创建一个新的pojo对象，存储分页信息</span>
		<span class="token class-name">PageInfo</span> pi<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">PageInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		pi<span class="token punctuation">.</span><span class="token function">setPageSize</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
		pi<span class="token punctuation">.</span><span class="token function">setPageNumber</span><span class="token punctuation">(</span>pageNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;pageStart&quot;</span><span class="token punctuation">,</span> pageSize<span class="token operator">*</span><span class="token punctuation">(</span>pageNumber<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;pageSize&quot;</span><span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
		pi<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token string">&quot;com.qym.mapper.FlowerMapper.selAll&quot;</span><span class="token punctuation">,</span>map<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">long</span> count<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token string">&quot;com.qym.mapper.FlowerMapper.selByPage&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		pi<span class="token punctuation">.</span><span class="token function">setTotal</span><span class="token punctuation">(</span>count<span class="token operator">%</span>pageSize<span class="token operator">==</span><span class="token number">0</span><span class="token operator">?</span>count<span class="token operator">/</span>pageSize<span class="token operator">:</span>count<span class="token operator">/</span>pageSize<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> pi<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><em>核心代码servlet实现</em></p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code>
<span class="token keyword">private</span> <span class="token class-name">FlowerService</span> fs<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FlowerServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">service</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span>
			<span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
		<span class="token comment">//先拿到size和number</span>
		<span class="token comment">//此处判断一下是否有size和number</span>
		<span class="token class-name">String</span> str1<span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;pageSize&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//给个默认值,每页显示3个</span>
		<span class="token keyword">int</span> pageSize<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>str1<span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>str1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			pageSize<span class="token operator">=</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token class-name">String</span> str2<span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;pageNumber&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//给个默认值,一次显示一页</span>
		<span class="token keyword">int</span> pageNumber<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>str2<span class="token operator">!=</span><span class="token keyword">null</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span>str2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			pageNumber<span class="token operator">=</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token class-name">PageInfo</span> pi<span class="token operator">=</span>fs<span class="token punctuation">.</span><span class="token function">showAll</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">,</span> pageNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>pi<span class="token punctuation">)</span><span class="token punctuation">;</span>
		req<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;pi&quot;</span><span class="token punctuation">,</span> pi<span class="token punctuation">)</span><span class="token punctuation">;</span>
		req<span class="token punctuation">.</span><span class="token function">getRequestDispatcher</span><span class="token punctuation">(</span><span class="token string">&quot;index.jsp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="接口绑定方案和多参数传递"><a href="#接口绑定方案和多参数传递" aria-hidden="true" class="header-anchor">#</a> 接口绑定方案和多参数传递</h2> <p>作用：实现创建一个接口后把mapper.xml由mybatis生成接口的实现类通过调用接口对象就可以获取到mapper.xml中编写的sql<br></p> <p><em>以后mybatis和spring整合的时候都是使用这个方案</em></p> <h3 id="一、实现步骤"><a href="#一、实现步骤" aria-hidden="true" class="header-anchor">#</a> 一、实现步骤</h3> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br></div><pre class="language-java"><code><span class="token operator">-</span><span class="token number">1.</span>创建一个接口
    <span class="token operator">--</span>接口包名和接口名与mapper<span class="token punctuation">.</span>xml中的namespace属性的属性值要相同
    <span class="token operator">--</span>在mybatis<span class="token punctuation">.</span>xml中使用<span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">package</span><span class="token punctuation">&gt;</span></span>标签进行扫描接口和mapper<span class="token punctuation">.</span>xml
    <span class="token operator">--</span>接口中方法名和mapper<span class="token punctuation">.</span>xml标签的id属性的属性值要相同
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="二、接口问题"><a href="#二、接口问题" aria-hidden="true" class="header-anchor">#</a> 二、接口问题</h3> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code>mapper里面的接口被实例化了，需要给接口一个实例化对象，此处使用JDK的动态代理设计模式，面向接口的代理设计模式（必须要有接口）

select标签里面，如果多参数的时候不需要写parameterType


mapper包下面存放mapper<span class="token punctuation">.</span>xml和mapper<span class="token punctuation">.</span>java的接口

<span class="token keyword">public</span> <span class="token keyword">interface</span> mapper<span class="token punctuation">{</span>
    <span class="token comment">//select标签里面的id必须是selAll了</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">People</span><span class="token punctuation">&gt;</span></span> <span class="token function">selAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//Param表示可以使用字符串作为map的value </span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">People</span><span class="token punctuation">&gt;</span></span> <span class="token function">selById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> decs<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>代码实现步骤</p> <div class="language-Xml line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-xml"><code>---在mybatis.xml中的<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>下使用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.qym.mapper<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>

---在com.qym.mapper下新建接口
    public interface PeopleMapper{
        List<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>People</span><span class="token punctuation">&gt;</span></span> selAll();
    }
---在com.qym.mapper新建一个PeopleMapper.xml
    ---namespace必须和接口是全限定路径（包名+类名）
    ---id值必须和接口方法名相同
    ---如果接口中方法为多个参数，可以省略parameterType
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.qym.mapper.PeopleMapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selAll<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>People<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                select * from people
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
---多参数实现办法
    ---在接口中声明方法
        list<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>People</span><span class="token punctuation">&gt;</span></span> seleById(String name,String desc);
    ---在mapper.xml中添加
        ---#{}中使用0,1,2或者param1,param2
        <span class="token comment">&lt;!-- 当多参数时，不需要写parameterType --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>seleById<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>People<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            select * from people where desc=#{0} and name=#{1}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
---可以使用注解方式
    ---在接口中声明方法
        //mybatis把参数转换为map了，其中@Param(&quot;key&quot;)参数内容就是map的value
        List<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>People</span><span class="token punctuation">&gt;</span></span> seleByOther(@Param(&quot;one&quot;) String on,@Param(&quot;two&quot;) String tw);
    ---在mapper.xml中添加
        ---在#{}里面写的@Param(&quot;内容&quot;)参数中内容
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>seleByOther<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>People<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            select * from People where desc=#{one} and name=#{two}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="动态sql"><a href="#动态sql" aria-hidden="true" class="header-anchor">#</a> 动态SQL</h2> <p>在mapper.xml里面添加逻辑判断</p> <div class="language-Xml line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-xml"><code>---使用if标签
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span>
    select * from People where 1=1
    <span class="token comment">&lt;!-- OGNL表达式，直接写key或对象的属性，不需要添加任何特殊字符 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accin!=null and accin!=''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        and accin=#{accin}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accout!=null and accout!=''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        and accout=#{accout}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

---使用where标签,去掉第一个and
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span>
    select * from People
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accin!=null and accin!=''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            and accin=#{accin}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accout!=null and accout='<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            and accout=#{accout}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

---使用choose where when组合标签,只会执行一个
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span>
    select * from People
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>choose</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accin!=null and accin!=''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            and accin=#{accin}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accout!=null and accout!=''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            and accout=#{accout}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>choose</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

---使用set标签，去掉最后一个逗号，如果<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">&gt;</span></span>里面有内容生成set关键字，没有就不生成
    ---id=#{id}是为了防止<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">&gt;</span></span>中没有内容，mybatis不生成set关键字
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span><span class="token punctuation">&gt;</span></span>
        update People
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">&gt;</span></span>
            id=#{id}
             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accin!=null and accin!=''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                and accin=#{accin}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accout!=null and accout='<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                and accout=#{accout}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">&gt;</span></span>
    
---使用trim标签
    ---prefix 在前面添加内容
    ---prefixOverrides 去掉前面内容
    ---suffix 在后面添加内容
    ---suffixOverrides 去掉后面内容
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span>
    select * from People
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>where<span class="token punctuation">&quot;</span></span> <span class="token attr-name">prefixOverrides</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>and<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span><span class="token punctuation">&gt;</span></span>
    update People
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>set<span class="token punctuation">&quot;</span></span> <span class="token attr-name">suffixOverrides</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    a=a,
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">&gt;</span></span>
    where id=100
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">&gt;</span></span>

---使用bind标签，给参数重新赋值，场景：模糊查询、在原内容前或后添加内容
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bind</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>accin<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>%'+accin+'%'<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    #{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

---使用foreach标签，循环参数内容，还具备在内容的前后添加内容，分隔符的功能，使用场景：in查询，批量新增中（mybatis中，foreach效率比较低）
    ---如果希望批量新增，SQL命令
    insert into People (default,1,2,3),(default,2,3,4)
    ---openSession必须指定(底层是JDBC的PreparedStatement.addBatch();
    factory.openSession(ExecutorType.BATCH);
    
    ---实例
        collection 要遍历的集合
        item 迭代变量 #{迭代变量名}获取内容
        open 循环后左侧添加的内容
        close 循环后右侧添加的内容
        separator 每次循环时，元素之间的分隔符
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select * from People where id in
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>(<span class="token punctuation">&quot;</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    
---使用sql标签和include标签
    ---某些sql片段如果希望复用，可以使用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sql</span><span class="token punctuation">&gt;</span></span>定义这个片段
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span>
        select <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">refid</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mysql<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">&gt;</span></span>
        from People
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sql</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mysql<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        id,accin,accout,money
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sql</span><span class="token punctuation">&gt;</span></span>
    
    ---在<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span><span class="token punctuation">&gt;</span></span>中使用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">&gt;</span></span>引用  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span>
        select <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">refid</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mysql<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">&gt;</span></span>
        from People
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
        
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br></div></div><h2 id="线程容器-threadlocal"><a href="#线程容器-threadlocal" aria-hidden="true" class="header-anchor">#</a> 线程容器 ThreadLocal</h2> <p>线程容器，给线程绑定一个Object内容后，只要线程不发生改变，可以随时取出object
<br>
改变线程，object就无法取出</p> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token comment">//改变线程 </span>
<span class="token keyword">final</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> tl<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ThreadLoacl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
tl<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;测试&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> result<span class="token operator">=</span>tl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;结果：&quot;</span><span class="token operator">+</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>factory实例化过程是一个比较耗费性能的过程，尽量保证只有一个factory</p> <h2 id="缓存"><a href="#缓存" aria-hidden="true" class="header-anchor">#</a> 缓存</h2> <p>应用程序和数据库交互的过程是一个相对比较耗时的过程
<br>缓存存在的意义：让应用程序减少对数据库的访问，提升程序运行效率</p> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token class-name">Mybatis</span>中默认开启<span class="token class-name">SqlSession</span>缓存
    <span class="token operator">--</span><span class="token operator">-</span>同一个<span class="token class-name">SqlSession</span>对象调用同一个<span class="token generics"><span class="token punctuation">&lt;</span>select<span class="token punctuation">&gt;</span></span>时，只有第一次访问数据库，第一次之后把查询结果缓存到<span class="token class-name">SqlSession</span>缓存区<span class="token punctuation">(</span>内存<span class="token punctuation">)</span>中
    <span class="token operator">--</span><span class="token operator">-</span>缓存的是statement对象
        <span class="token operator">--</span><span class="token operator">-</span>在mybatis中，一个<span class="token generics"><span class="token punctuation">&lt;</span>select<span class="token punctuation">&gt;</span></span>对应一个statement对象
    <span class="token operator">--</span><span class="token operator">-</span>有效范围必须是同一个<span class="token class-name">SqlSession</span>对象
缓存流程
    <span class="token operator">--</span><span class="token operator">-</span>先去缓存区中找是否存在statement
    <span class="token operator">--</span><span class="token operator">-</span>返回结果
    <span class="token operator">--</span><span class="token operator">-</span>如果没有缓存statement对象，去数据库中获取数据
    <span class="token operator">--</span><span class="token operator">-</span>数据库返回查询结果
    <span class="token operator">--</span><span class="token operator">-</span>把查询结果放到对应的缓存区中
<span class="token class-name">SqlSessionFactory</span>缓存
    <span class="token operator">--</span><span class="token operator">-</span>二级缓存
    <span class="token operator">--</span><span class="token operator">-</span>有效范围：同一个factory内那个<span class="token class-name">SqlSession</span>都可以获取
    <span class="token operator">--</span><span class="token operator">-</span>当数据很少被修改，经常被使用的时候使用二级缓存

    <span class="token operator">--</span><span class="token operator">-</span>在mapper<span class="token punctuation">.</span>xml中添加
    <span class="token operator">--</span><span class="token operator">-</span>如果不写readOnly<span class="token operator">=</span><span class="token string">&quot;true&quot;</span>，则需要把实体类系列化
    <span class="token operator">&lt;</span>cache readOnly<span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>cache<span class="token operator">&gt;</span>
    <span class="token operator">--</span><span class="token operator">-</span>当<span class="token class-name">SqlSession</span>对象<span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>或<span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>时，会把<span class="token class-name">SqlSession</span>缓存的数据刷<span class="token punctuation">(</span>flush<span class="token punctuation">)</span>到<span class="token class-name">SqlSessionFactory</span>的缓存区当中
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="实现多表查询"><a href="#实现多表查询" aria-hidden="true" class="header-anchor">#</a> 实现多表查询</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>---实现多表查询方式
    ---业务装配，对两个表编写表单查询语句，在业务把查询的两个结果进行关联
    ---使用Auto Mapping特性，在实现两个表联合查询时通过别名完成映射
    ---使用Myabtis的&lt;resultMap&gt;标签进行实现
---多表查询时，类中包干另一个类的对象的分类
    ---单个对象
    ---集合对象

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="resultmap标签"><a href="#resultmap标签" aria-hidden="true" class="header-anchor">#</a> resultMap标签</h3> <div class="language-Xml line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-xml"><code>---resultMap标签写在mapper.xml中,由程序员控制SQL查询结果与实体类的映射关系
    ---默认Mybatis使用Auto Mapping特性
        ---使用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultType</span><span class="token punctuation">&gt;</span></span>标签时,<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span><span class="token punctuation">&gt;</span></span>标签不写 resultType属性，而是使用resultMap属性引用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span><span class="token punctuation">&gt;</span></span>标签
            ---mapper.xml配置
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>teacher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mymap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                //主键使用 id 标签配置映射关系
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
                //其他列使用 result 标签配置映射关系
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selAll<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mymap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    select * from teacher
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
                
---使用resultMap实现关联单个对象(N+1)方式
    ---N+1查询方式，先查询出某个表的全部信息，根据这个表的信息查询到另一个表的信息
    ---与业务员装配的区别
        ---在service里面写的代码现在由mybatis装配
    ---实现步骤
        ---在主类Student中添加一个Teacher对象
        ---在Teacher.xml中提供一个查询
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selById<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>teacher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                select * from teacher where id=#{0}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
        ---在StudentMapper中做以下配置
            ---<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span><span class="token punctuation">&gt;</span></span>装配一个对象时使用
            ---property:Teacher对象在Student类中的属性名
            ---select:通过那个查询来查询出这个对象的信息
            ---column:把当前表的那个列的值作为参数传递给另一个查询
            ---大前提使用N+1方式时如果列名和属性名相同可以不配置，但是不会返回对应的值，使用Auto mapping特性，但是mybatis默认只会给列专配一次
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>student<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stuMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                    //如果关联一个对象
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>teacher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.bjsxt.mapper.TeacherMapper.selById<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>association</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selAll<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stuMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    select * from student
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
                
            //简化后得到
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>student<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stuMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                    // 如果关联一个对象
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>teacher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.bjsxt.mapper.TeacherMapper.selById<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>association</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selAll<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stuMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    select * from student
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
        
        ---使用resultMap实现关联单个对象(联合查询方式)
            ---只需要编写一个 SQL,在 StudentMapper 中添加下面效果
            --- <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span><span class="token punctuation">/&gt;</span></span>只要专配一个对象就用这个标签
            --- 此时把<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span><span class="token punctuation">/&gt;</span></span>小的<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span><span class="token punctuation">&gt;</span></span>看待
            --- javaType 属性:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span><span class="token punctuation">/&gt;</span></span>专配完后返回一个什么类型的对象.取值是一个类(或类的别名)
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Student<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stuMap1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sname<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>teacher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">javaType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Teacher<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tname<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>association</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selAll1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>stuMap1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                 select s.id sid,s.name sname,age age,t.itid,t.name tname FROM student s left outer join teacher t on s.tid=t.id
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
            
        --- N+1 方式和联合查询方式对比
            --- N+1:需求不确定时6.2 联合查询:需求中确定查询时两个表一定都查询.
        ---N+1 名称由来
            --- 举例:学生中有 3 条数据
            --- 需求:查询所有学生信息级授课老师信息
            --- 需要执行的 SQL 命令
            --- 查询全部学生信息:select * from 学7.3.2 执行 3 遍 select * from 老师 where id=学生的外键
            --- 使用多条 SQl 命令查询两表数据时,如果希望把需要的数据都 查询出来,需要执行 N+1 条 SQl 才能把所有数据库查询出来
            ---缺点:效率低
            --- 优点: 如果有的时候不需要查询学生是同时查询老师.只需执行一个 select * from student;
            --- 适用场景: 有的时候需要查询学生同时查询老师,有的时候只需要查询学生.
            ---如果解决 N+1 查询带来的效率低的问题
            --- 默认带的前提: 每次都是两个都查询 使用两表联合查询.


---使用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span><span class="token punctuation">&gt;</span></span>查询关联集合对象(N+1)
    ---在 Teacher 中添加 List<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Student</span><span class="token punctuation">&gt;</span></span>
        public class Teacher {
        private int id;
        private String name;
        private List<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Student</span><span class="token punctuation">&gt;</span></span> list;
    --- 在 StudentMapper.xml 中添加通过 tid 查询
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selByTid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span><span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>student<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            select * from student where tid=#{0}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    ---在 TeacherMapper.xml 中添加查询全部
        ---<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span><span class="token punctuation">/&gt;</span></span> 当属性是集合类型时使用的标签. 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>teacher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mymap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.bjsxt.mapper.StudentMapper.selByTid<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selAll<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mymap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                select * from teacher
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
---使用<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span><span class="token punctuation">&gt;</span></span>实现加载集合数据(联合查询方式)
    ---在 teacherMapper.xml 中添加
        ---mybatis 可以通过主键判断对象是否被加载过 
        --- 不需要担心创建重复 Teacher
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>teacher<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mymap1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tname<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>student<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sname<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tid<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selAll1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mymap1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                select t.id tid,t.name tname,s.id sid,s.namsname,age,tid from teacher t LEFT JOIN student s on t.id=s.tid;
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
---使用 Auto Mapping 结合别名实现多表查询
    --- 只能使用多表联合查询方式. 5.2 要求:查询出的列别和属性名相同. 5.3 实现方式
        ---在 SQL 是关键字符,两侧添加反单引号
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>selAll<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>student<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                select t.id `teacher.id`,t.name `teacher.name`,s.id id,s.name name,age,tid from student s LEFT JOIN teacher t on t.id=s.tid
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br></div></div><h3 id="mybatis-注解"><a href="#mybatis-注解" aria-hidden="true" class="header-anchor">#</a> MyBatis 注解</h3> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token operator">--</span><span class="token operator">-</span><span class="token class-name">MyBatis</span> 注解
    <span class="token operator">--</span><span class="token operator">-</span>注解<span class="token operator">:</span>为了简化配置文件<span class="token punctuation">.</span> 
    <span class="token operator">--</span><span class="token operator">-</span><span class="token class-name">Mybatis</span> 的注解简化 mapper<span class="token punctuation">.</span>xml 文件
        <span class="token operator">--</span><span class="token operator">-</span>如果涉及动态 SQL 依然使用 mapper<span class="token punctuation">.</span>xml
    <span class="token operator">--</span><span class="token operator">-</span>mapper<span class="token punctuation">.</span>xml 和注解可以共存<span class="token punctuation">.</span> 
    <span class="token operator">--</span><span class="token operator">-</span>使用注解时 mybatis<span class="token punctuation">.</span>xml 中<span class="token generics"><span class="token punctuation">&lt;</span>mappers<span class="token punctuation">&gt;</span></span>使用
        <span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token keyword">package</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&lt;</span>mapper <span class="token keyword">class</span><span class="token operator">=</span>””<span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">--</span><span class="token operator">-</span>实现查询
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">&quot;select * from teacher&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Teacher</span><span class="token punctuation">&gt;</span></span> <span class="token function">selAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">-</span>实现新增
    <span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span>&quot;insert into teacher
    <span class="token function">values</span><span class="token punctuation">(</span><span class="token keyword">default</span><span class="token punctuation">,</span>#<span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">)</span>&quot;<span class="token punctuation">)</span>
    <span class="token keyword">int</span> <span class="token function">insTeacher</span><span class="token punctuation">(</span><span class="token class-name">Teacher</span> teacher<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">-</span>实现修改
    <span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token string">&quot;update teacher set name=#{name} where id=#{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">int</span> <span class="token function">updTeacher</span><span class="token punctuation">(</span><span class="token class-name">Teacher</span> teacher<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">-</span>实现删除
    <span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">&quot;delete from teacher where id=#{0}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">int</span> <span class="token function">delById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">-</span>使用注解实现<span class="token generics"><span class="token punctuation">&lt;</span>resultMap<span class="token punctuation">&gt;</span></span>功能
    <span class="token operator">--</span><span class="token operator">-</span>以 <span class="token class-name">N</span><span class="token operator">+</span><span class="token number">1</span> 举例
        <span class="token operator">--</span><span class="token operator">-</span>在 <span class="token class-name">StudentMapper</span> 接口添加查询
            <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">&quot;select * from student where tid=#{0}&quot;</span><span class="token punctuation">)</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token function">selByTid</span><span class="token punctuation">(</span><span class="token keyword">int</span> tid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">--</span><span class="token operator">-</span>在 <span class="token class-name">TeacherMapper</span> 接口添加
        <span class="token operator">--</span><span class="token operator">-</span><span class="token annotation punctuation">@Results</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 相当于<span class="token generics"><span class="token punctuation">&lt;</span>resultMap<span class="token punctuation">&gt;</span></span>
        <span class="token operator">--</span><span class="token operator">-</span><span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 相当于<span class="token operator">&lt;</span>id<span class="token operator">/</span><span class="token operator">&gt;</span>或<span class="token operator">&lt;</span>result<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">--</span><span class="token operator">-</span><span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span> 相当与<span class="token operator">&lt;</span>id<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">--</span><span class="token operator">-</span><span class="token annotation punctuation">@Many</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 相当于<span class="token operator">&lt;</span>collection<span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">--</span><span class="token operator">-</span><span class="token annotation punctuation">@One</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 相当于<span class="token operator">&lt;</span>association<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token annotation punctuation">@Results</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>property<span class="token operator">=</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property<span class="token operator">=</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property<span class="token operator">=</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token annotation punctuation">@Many</span><span class="token punctuation">(</span>select<span class="token operator">=</span><span class="token string">&quot;com.bjsxt.mapper.StudentMapper.selByTid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">&quot;select * from teacher&quot;</span><span class="token punctuation">)</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Teacher</span><span class="token punctuation">&gt;</span></span> <span class="token function">selTeacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="运行原理"><a href="#运行原理" aria-hidden="true" class="header-anchor">#</a> 运行原理</h3> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token operator">--</span><span class="token operator">-</span>运行过程中涉及到的类
    <span class="token operator">--</span><span class="token operator">-</span><span class="token class-name">Resources</span> <span class="token class-name">MyBatis</span> 中 IO 流的工具类
    <span class="token operator">--</span><span class="token operator">-</span>加载配置文件
    <span class="token operator">--</span><span class="token operator">-</span><span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 构建器
        <span class="token operator">--</span><span class="token operator">-</span>作用<span class="token operator">:</span>创建 <span class="token class-name">SqlSessionFactory</span> 接口的实现类
    <span class="token operator">--</span><span class="token operator">-</span><span class="token class-name">XMLConfigBuilder</span> <span class="token class-name">MyBatis</span>全局配置文件内容构建器类
        <span class="token operator">--</span><span class="token operator">-</span>作用负责读取流内容并转换为 JAVA 代码<span class="token punctuation">.</span> 
    <span class="token operator">--</span><span class="token operator">-</span> <span class="token class-name">Configuration</span> 封装了全局配置文件所有配置信息       <span class="token operator">--</span><span class="token operator">-</span>全局配置文件内容存放在 <span class="token class-name">Configuration</span> 中
    <span class="token operator">--</span><span class="token operator">-</span><span class="token class-name">DefaultSqlSessionFactory</span>是<span class="token class-name">SqlSessionFactory</span>接扣的实现类
    <span class="token operator">--</span><span class="token operator">-</span><span class="token class-name">Transaction</span> 事务类
        <span class="token operator">--</span><span class="token operator">-</span>每一个 <span class="token class-name">SqlSession</span> 会带有一个 <span class="token class-name">Transaction</span> 对象<span class="token punctuation">.</span> 
    <span class="token operator">--</span><span class="token operator">-</span><span class="token class-name">TransactionFactory</span> 事务工厂
        <span class="token operator">--</span><span class="token operator">-</span>负责生产 <span class="token class-name">Transaction</span>
    <span class="token operator">--</span><span class="token operator">-</span> <span class="token class-name">Executor</span> <span class="token class-name">MyBatis</span> 执行器
        <span class="token operator">--</span><span class="token operator">-</span> 作用<span class="token operator">:</span>负责执行 SQL 命令
        <span class="token operator">--</span><span class="token operator">-</span> 相当于 JDBC 中 statement 对象<span class="token punctuation">(</span>或<span class="token class-name">PreparedStatement</span>或 <span class="token class-name">CallableStatement</span><span class="token punctuation">)</span>
        <span class="token operator">--</span><span class="token operator">-</span> 默认的执行器 <span class="token class-name">SimpleExcutor</span>
        <span class="token operator">--</span><span class="token operator">-</span> 批量操作 <span class="token class-name">BatchExcutor</span>
        <span class="token operator">--</span><span class="token operator">-</span> 通过 <span class="token function">openSession</span><span class="token punctuation">(</span>参数控制<span class="token punctuation">)</span>
    <span class="token operator">--</span><span class="token operator">-</span> <span class="token class-name">DefaultSqlSession</span> 是 <span class="token class-name">SqlSession</span> 接口的实现类
    <span class="token operator">--</span><span class="token operator">-</span><span class="token class-name">ExceptionFactory</span> <span class="token class-name">MyBatis</span> 中异常工厂
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>流程</p> <p><img src="https://i.loli.net/2019/10/26/5kwdHpFgQOKzhIn.png" alt="image.png"></p> <div class="language-Java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code>解释
<span class="token operator">--</span><span class="token operator">-</span>在 <span class="token class-name">MyBatis</span> 运行开始时需要先通过 <span class="token class-name">Resources</span>加载全局配置文件<span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">-</span>下面需要实例化 <span class="token class-name">SqlSessionFactoryBuilder</span> 构建器
<span class="token operator">--</span><span class="token operator">-</span>帮助 <span class="token class-name">SqlSessionFactory</span>接口实现类<span class="token class-name">DefaultSqlSessionFactory</span><span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">-</span>在实例化 <span class="token class-name">DefaultSqlSessionFactory</span>之前需要先创建<span class="token class-name">XmlConfigBuilder</span>解析全局配置文件流<span class="token punctuation">,</span>并把解析结果存放在 <span class="token class-name">Configuration</span> 中<span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">-</span>之后把<span class="token class-name">Configuratin</span>传递给 <span class="token class-name">DefaultSqlSessionFactory</span><span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">-</span>到此 <span class="token class-name">SqlSessionFactory</span> 工厂创建成功<span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">-</span>由 <span class="token class-name">SqlSessionFactory</span> 工厂创建 <span class="token class-name">SqlSession</span><span class="token punctuation">.</span> 每次创建 <span class="token class-name">SqlSession</span> 时<span class="token punctuation">,</span>都需要由 <span class="token class-name">TransactionFactory</span>创建<span class="token class-name">Transaction</span>对象<span class="token punctuation">,</span>同时还需要创建 <span class="token class-name">SqlSession</span> 的执行器 <span class="token class-name">Excutor</span><span class="token punctuation">,</span>最后实例化<span class="token class-name">DefaultSqlSession</span><span class="token punctuation">,</span>传递给 <span class="token class-name">SqlSession</span> 接口<span class="token punctuation">.</span> 
<span class="token operator">--</span><span class="token operator">-</span>根据项目需求使用 <span class="token class-name">SqlSession</span> 接口中的 API完成具体的事务操作<span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">-</span>如果事务执行失败<span class="token punctuation">,</span>需要进行rollback 回滚事务<span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">-</span>如果事务执行成功提交给数据库<span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">-</span>关闭 <span class="token class-name">SqlSession</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/kirigayakazima/JavaDesign/edit/master/FrameBook/Mybatis01.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新时间：: </span> <span class="time">11/2/2019, 11:09:55 AM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/JavaDesign/FrameBook/Log4j.html">
          Log4j
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/JavaDesign/assets/js/app.e7717cda.js" defer></script><script src="/JavaDesign/assets/js/2.1544abce.js" defer></script><script src="/JavaDesign/assets/js/9.a69063dc.js" defer></script>
  </body>
</html>
